<?xml version="1.0" encoding="utf-8"?>
<ArrayOfSBADescriptor xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <SBADescriptor>
    <SBAId>3a163cd5-2e3e-4c42-9711-30dc9d0c0125</SBAId>
    <RootSBAId>3bbb632f-9cfe-472c-8a9f-b4e308ab1376</RootSBAId>
    <StoreId>d159c1e2-9a6c-4324-bbe8-a69e941c6b98</StoreId>
    <SQN>638148362197939820</SQN>
    <Name>Disable Horizon Pool Provisioning</Name>
    <Description>Disables VMware Horizon Virtual Desktop pool provisioning

Can be used as a manual or automated action to disable Horizon View Virtual Desktop pool provisioning if a resource shortage is detected. This action should be executed against a Horizon endpoint machine (one which has the HZ Primary Connection Server column populated in ControlUp Console) which is part of the relevant Desktop Pool. The script uses the target machine to determine the connection server address and the Desktop Pool name, and is executed on the machine running ControlUp Console.

This script requires VMWare PowerCLI module to be installed on the machine running the script.
PowerCLI can be installed through PowerShell (PowerShell version 5 or higher required) by running the command 'Install-Module VMWare.PowerCLI -Force -AllowCLobber -Scope AllUsers'</Description>
    <Category>Horizon Management</Category>
    <Version>3.13.29</Version>
    <DateCreated>2019-08-22T12:24:32.013</DateCreated>
    <DateModified>2023-05-24T13:41:56.13</DateModified>
    <DatePublished>2023-05-26T09:55:41.18</DatePublished>
    <LastEditorName>Guy Leech</LastEditorName>
    <CreatorName>Ton de Vreede</CreatorName>
    <Status>3</Status>
    <CheckSum>tVKf7D6fiNCu9ZYYWmxcbw1dGr4=</CheckSum>
    <EULAVersion>1.0.0.0</EULAVersion>
    <DenyCommunityShare>false</DenyCommunityShare>
    <Icon>
      <IconData />
      <IconType>0</IconType>
    </Icon>
    <ShareDescriptor>
      <Author>Wouter Kursten</Author>
      <Tags>vmware,horizon,provisioning</Tags>
      <Credits>Credits to: Ton de Vreede
Original code by:
Taken from:</Credits>
      <AllowExposeEmail>true</AllowExposeEmail>
      <ContactEmail>bill.powell@controlup.com</ContactEmail>
      <Notes />
      <DownloadCount>0</DownloadCount>
    </ShareDescriptor>
    <ExecutionDescriptor>
      <AllowedEntitiesEx>256</AllowedEntitiesEx>
      <AtomicEntityEx>256</AtomicEntityEx>
      <AllowedEntities>0</AllowedEntities>
      <AtomicEntity>0</AtomicEntity>
      <ScriptData>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</ScriptData>
      <IsCompressed>true</IsCompressed>
      <Interactive>false</Interactive>
      <AltCredentialsType>5</AltCredentialsType>
      <Timeout>180</Timeout>
      <ScriptType>3</ScriptType>
      <TimeoutPolicy>1</TimeoutPolicy>
      <ConcurrencyMode>1</ConcurrencyMode>
      <ExecutionContext>3</ExecutionContext>
      <Arguments>
        <inner>
          <sxSerializedDictionaryOfStringSBAArgumentDescriptor>
            <item>
              <key>
                <string>1e27562c-8ab4-4253-8e5f-c5016d0c647b</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>1e27562c-8ab4-4253-8e5f-c5016d0c647b</ArgumentId>
                  <ArgumentType>2</ArgumentType>
                  <DefaultValue />
                  <ArgumentNumber>1</ArgumentNumber>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationError />
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>256</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
            <item>
              <key>
                <string>f6016b62-d946-461d-92e9-84a74d88944e</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>f6016b62-d946-461d-92e9-84a74d88944e</ArgumentId>
                  <ArgumentType>2</ArgumentType>
                  <DefaultValue />
                  <ArgumentNumber>0</ArgumentNumber>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationError />
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>256</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
          </sxSerializedDictionaryOfStringSBAArgumentDescriptor>
        </inner>
      </Arguments>
      <InstructionsExecutionOnComputer />
      <SupressOutputDialog>false</SupressOutputDialog>
      <UseSdk>false</UseSdk>
    </ExecutionDescriptor>
    <MissingCred>false</MissingCred>
    <ImportValidationString>nDaFNlUtmLhohs+7QTPXN8Pg5QA=</ImportValidationString>
    <IsVersionAudited>false</IsVersionAudited>
  </SBADescriptor>
</ArrayOfSBADescriptor>