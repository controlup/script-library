<?xml version="1.0" encoding="utf-8"?>
<ArrayOfSBADescriptor xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <SBADescriptor>
    <SBAId>2da8d377-88cf-4429-90f7-52f84ebb9116</SBAId>
    <RootSBAId>f354e6fa-a436-4532-b5df-820a483787b2</RootSBAId>
    <StoreId>d159c1e2-9a6c-4324-bbe8-a69e941c6b98</StoreId>
    <SQN>638343656006815771</SQN>
    <Name>Set AD User Password</Name>
    <Description>Sets a new password for an AD User and requires the user to change the password at next logon.</Description>
    <ActionCategory>User Environment</ActionCategory>
    <Version>3.0.8</Version>
    <DateCreated>2023-06-05T09:33:23.673</DateCreated>
    <DateModified>2023-06-23T14:22:26.323</DateModified>
    <DatePublished>2023-10-31T16:13:20.68</DatePublished>
    <LastEditorName>Rein Leen</LastEditorName>
    <CreatorName>Rein Leen/Bill Powell</CreatorName>
    <Status>3</Status>
    <CheckSum>d1MQTf4dAygqx4YZ0tZIKfi0o8M=</CheckSum>
    <EULAVersion>1.0.0.0</EULAVersion>
    <DenyCommunityShare>false</DenyCommunityShare>
    <Icon>
      <IconData />
      <IconType>0</IconType>
    </Icon>
    <ShareDescriptor>
      <Author>Rein Leen</Author>
      <Tags>Active Directory,security</Tags>
      <Credits>Credits to: Bill Powell
Original idea by: Bill Powell
Taken from:</Credits>
      <AllowExposeEmail>true</AllowExposeEmail>
      <ContactEmail>bill.powell@controlup.com</ContactEmail>
      <Notes>This script makes use of the what3words API described at https://developer.what3words.com/public-api to convert random numbers to memorable three word strings, creating human-memorable passwords as illustrated by the well-known comic https://xkcd.com/936/

While the what3words API is free at the time of writing, you should check the current Terms &amp; Conditions when using this API. 

You use this API at your own risk. Neither the authors, nor ControlUp accept any liability arising from misuse of the API or any breaches of licensing terms.

In particular, note that you are not allowed to store any geographic information returned by the API. What3words implements a Fair usage policy.

This script makes use of Microsoft's ActiveDirectory module, which should be installed on the target machine where the script is run. This can be any domain-joined Windows machine.

The powershell ActiveDirectory module is distributed as part of Microsoft's Remote Server Administration Tools (RSAT).

On a current Windows Server, you can install RSAT from an administrator prompt:

    Install-WindowsFeature RSAT-AD-PowerShell

For Windows 11, download the Remote Server Administration Tools from Microsoft's web site. RSAT may not be available for some older Windows versions, or may have additional requirements.

When making changes to Active Directory objects, you will need to provide credentials with appropriate privileges.
</Notes>
      <DownloadCount>0</DownloadCount>
    </ShareDescriptor>
    <ExecutionDescriptor>
      <AllowedEntitiesEx>256</AllowedEntitiesEx>
      <AtomicEntityEx>256</AtomicEntityEx>
      <AllowedEntities>0</AllowedEntities>
      <AtomicEntity>0</AtomicEntity>
      <ScriptData>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</ScriptData>
      <IsCompressed>true</IsCompressed>
      <Interactive>false</Interactive>
      <AltCredentialsType>3</AltCredentialsType>
      <Timeout>60</Timeout>
      <ScriptType>3</ScriptType>
      <TimeoutPolicy>1</TimeoutPolicy>
      <ConcurrencyMode>2</ConcurrencyMode>
      <ExecutionContext>0</ExecutionContext>
      <Arguments>
        <inner>
          <sxSerializedDictionaryOfStringSBAArgumentDescriptor>
            <item>
              <key>
                <string>7d776b66-4fb8-4f27-8458-4836ba98fb90</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>7d776b66-4fb8-4f27-8458-4836ba98fb90</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>APIKey</Name>
                  <DefaultValue />
                  <ArgumentNumber>0</ArgumentNumber>
                  <ArgumentName>APIKey</ArgumentName>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString>^\S+$</ValidationString>
                  <ValidationError>Please enter your personal what3words API key.</ValidationError>
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
            <item>
              <key>
                <string>2b03c99d-9758-4d1a-a132-adc985b05f08</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>2b03c99d-9758-4d1a-a132-adc985b05f08</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>User</Name>
                  <DefaultValue />
                  <ArgumentNumber>1</ArgumentNumber>
                  <ArgumentName>User</ArgumentName>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString>^\S+$</ValidationString>
                  <ValidationError>Please enter a username (SamAccountName or UPN)</ValidationError>
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
            <item>
              <key>
                <string>3e7d0609-30cf-401d-9da7-1b40cd65bb9a</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>3e7d0609-30cf-401d-9da7-1b40cd65bb9a</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>MinimalPasswordLength</Name>
                  <DefaultValue>20</DefaultValue>
                  <ArgumentNumber>2</ArgumentNumber>
                  <ArgumentName>MinimalPasswordLength</ArgumentName>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString>\d+|$|none|-</ValidationString>
                  <ValidationError>Please enter a number or leave empty (use null if not using the .NET engine) to default to 20</ValidationError>
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
          </sxSerializedDictionaryOfStringSBAArgumentDescriptor>
        </inner>
      </Arguments>
      <InstructionsExecutionOnComputer />
      <SupressOutputDialog>false</SupressOutputDialog>
      <UseSdk>false</UseSdk>
    </ExecutionDescriptor>
    <MissingCred>false</MissingCred>
    <ImportValidationString>mcghaKc4GRPUbFCxspdRZp7mM6k=</ImportValidationString>
    <IsVersionAudited>false</IsVersionAudited>
  </SBADescriptor>
</ArrayOfSBADescriptor>