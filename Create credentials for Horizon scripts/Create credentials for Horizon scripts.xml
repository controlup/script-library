<?xml version="1.0" encoding="utf-8"?>
<ArrayOfSBADescriptor xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <SBADescriptor>
    <SBAId>42c064c2-78bd-44a0-85be-3281f59c64bf</SBAId>
    <RootSBAId>ce44ec06-c8c7-4b1f-b4f4-105a17aa811c</RootSBAId>
    <StoreId>d159c1e2-9a6c-4324-bbe8-a69e941c6b98</StoreId>
    <SQN>637430121449227017</SQN>
    <Name>Create credentials for Horizon scripts</Name>
    <Description>Connecting to a Horizon Connection server is required for running Horizon scripts. The server does not allow passthrough (Active Directory) authentication. In order to allow scripts to run without asking for a password each time (such as in Automated Actions) a PSCredential object needs to be stored on each target device (i.e. each machine that will be used for running Horizon scripts). This script can create this PSCredential object on the targets.
PSCREDENTIIAL OBJECTS CAN ONLY BE USED BY THE USER THAT CREATED THE OBJECT AND ON THE MACHINE THE OBJECT WAS CREATED.
    - The User that creates the file is required to have a local profile when creating the file. This is a limitation from Powershell
    
    Modification history:   20/08/2019 - Anthonie de Vreede - First version
                            03/06/2020 - Wouter Kursten - Second version

    Changelog ;
        Second Version
            - Added check for local profile
            - changed error message when failing to create the xml file</Description>
    <Category />
    <Version>5.6.14</Version>
    <DateCreated>2019-12-02T14:12:29.97</DateCreated>
    <DateModified>2020-12-08T07:57:09.303</DateModified>
    <DatePublished>2020-12-08T07:56:53.093</DatePublished>
    <LastEditorName>Wouter Kursten</LastEditorName>
    <CreatorName>Ton de Vreede</CreatorName>
    <Status>4</Status>
    <CheckSum>I9JmJlAPnaKy3C0DyQSB9fGSYx8=</CheckSum>
    <EULAVersion>1.0.0.0</EULAVersion>
    <DenyCommunityShare>false</DenyCommunityShare>
    <Icon>
      <IconData />
      <IconType>0</IconType>
    </Icon>
    <ShareDescriptor>
      <Author>Ton de Vreede</Author>
      <Tags>horizon,credentials</Tags>
      <Credits>Credits to: theartvark
Original code by:
Taken from:</Credits>
      <AllowExposeEmail>true</AllowExposeEmail>
      <ContactEmail>wouter.kursten@controlup.com</ContactEmail>
      <Notes />
      <DownloadCount>254</DownloadCount>
    </ShareDescriptor>
    <ExecutionDescriptor>
      <AllowedEntitiesEx>256</AllowedEntitiesEx>
      <AtomicEntityEx>256</AtomicEntityEx>
      <AllowedEntities>0</AllowedEntities>
      <AtomicEntity>0</AtomicEntity>
      <ScriptData>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</ScriptData>
      <IsCompressed>true</IsCompressed>
      <Interactive>false</Interactive>
      <AltCredentialsType>3</AltCredentialsType>
      <Timeout>120</Timeout>
      <ScriptType>3</ScriptType>
      <TimeoutPolicy>1</TimeoutPolicy>
      <ConcurrencyMode>2</ConcurrencyMode>
      <ExecutionContext>0</ExecutionContext>
      <Arguments>
        <inner>
          <sxSerializedDictionaryOfStringSBAArgumentDescriptor>
            <item>
              <key>
                <string>47ede4f8-1bb5-4928-b9f9-c3182fa4e70a</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>47ede4f8-1bb5-4928-b9f9-c3182fa4e70a</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>Password</Name>
                  <DefaultValue />
                  <ArgumentNumber>1</ArgumentNumber>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString>.+</ValidationString>
                  <ValidationError>Please the password to be used for your Horizon View account.</ValidationError>
                  <MaskTypedCharacters>true</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
            <item>
              <key>
                <string>11d4fc6a-45d0-4591-9991-a3b47867788c</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>11d4fc6a-45d0-4591-9991-a3b47867788c</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>Username</Name>
                  <DefaultValue />
                  <ArgumentNumber>0</ArgumentNumber>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString>.+</ValidationString>
                  <ValidationError>Please enter a username to be used for your Horizon View account. This account should have the permissions required for the actions you would like to use in Horizon View.</ValidationError>
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
            <item>
              <key>
                <string>5fe601e9-5e94-42b3-ab35-64cb2a999519</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>5fe601e9-5e94-42b3-ab35-64cb2a999519</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>Confirm password</Name>
                  <DefaultValue />
                  <ArgumentNumber>2</ArgumentNumber>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString>.+</ValidationString>
                  <ValidationError>Please confirm your password  to be used for your Horizon View account.</ValidationError>
                  <MaskTypedCharacters>true</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
          </sxSerializedDictionaryOfStringSBAArgumentDescriptor>
        </inner>
      </Arguments>
      <InstructionsExecutionOnComputer />
      <SupressOutputDialog>false</SupressOutputDialog>
      <UseSdk>false</UseSdk>
    </ExecutionDescriptor>
    <MissingCred>false</MissingCred>
    <ImportValidationString>25hyM7eQKCy9zfcEAjHVSD4fQT4=</ImportValidationString>
    <IsVersionAudited>false</IsVersionAudited>
  </SBADescriptor>
</ArrayOfSBADescriptor>