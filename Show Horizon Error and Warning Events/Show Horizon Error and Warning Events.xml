<?xml version="1.0" encoding="utf-8"?>
<ArrayOfSBADescriptor xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <SBADescriptor>
    <SBAId>906fd782-926f-4cdf-aaa5-17a9fb41d8b7</SBAId>
    <RootSBAId>a692d74b-537d-40e1-b436-3b95447acbcf</RootSBAId>
    <StoreId>d159c1e2-9a6c-4324-bbe8-a69e941c6b98</StoreId>
    <SQN>638343656484982114</SQN>
    <Name>Show Horizon Error and Warning Events</Name>
    <Description>Uses the Horizon REST api's to pull all Error, Warning and Audit_Fail events from the Horizon Event database for all pods. If there is no cloud pod setup it will only process the local pod. After pulling the events it will translate the id's for the various objects to names to show the proper names where needed. 

Output is displayed in the console but also saved to a default location of c:windows\temp\CU_Horizon_error_log.csv

This action should be executed against a Horizon endpoint machine (one which has the HZ Primary Connection Server column populated in ControlUp Console). The script uses the target machine to determine the connection server address, and is executed on the machine running ControlUp Console.
This script requires Horizon Credentials to be set for the account running the scipt on the target machine, these need to be created using the 'Create credentials for Horizon scripts' Script Action</Description>
    <ActionCategory>Horizon Management</ActionCategory>
    <Version>4.3.12</Version>
    <DateCreated>2020-08-27T09:54:22.613</DateCreated>
    <DateModified>2023-10-25T15:59:20.743</DateModified>
    <DatePublished>2023-10-31T16:14:08.497</DatePublished>
    <LastEditorName>Wouter Kursten</LastEditorName>
    <CreatorName>Wouter Kursten</CreatorName>
    <Status>3</Status>
    <CheckSum>XNpG2EHsK2/HSlMA7kitgKyLsI4=</CheckSum>
    <EULAVersion>1.0.0.0</EULAVersion>
    <DenyCommunityShare>false</DenyCommunityShare>
    <Icon>
      <IconData />
      <IconType>0</IconType>
    </Icon>
    <ShareDescriptor>
      <Author>Wouter Kursten</Author>
      <Tags>vmware,horizon,vdi</Tags>
      <Credits>Credits to: Wouter Kursten
Original code by:
Taken from:</Credits>
      <AllowExposeEmail>true</AllowExposeEmail>
      <ContactEmail>wouter.kursten@controlup.com</ContactEmail>
      <Notes />
      <DownloadCount>0</DownloadCount>
    </ShareDescriptor>
    <ExecutionDescriptor>
      <AllowedEntitiesEx>256</AllowedEntitiesEx>
      <AtomicEntityEx>256</AtomicEntityEx>
      <AllowedEntities>0</AllowedEntities>
      <AtomicEntity>0</AtomicEntity>
      <ScriptData>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</ScriptData>
      <IsCompressed>true</IsCompressed>
      <Interactive>false</Interactive>
      <AltCredentialsType>1</AltCredentialsType>
      <Timeout>600</Timeout>
      <ScriptType>3</ScriptType>
      <TimeoutPolicy>1</TimeoutPolicy>
      <ConcurrencyMode>2</ConcurrencyMode>
      <ExecutionContext>1</ExecutionContext>
      <Arguments>
        <inner>
          <sxSerializedDictionaryOfStringSBAArgumentDescriptor>
            <item>
              <key>
                <string>8e04d032-bad3-4e88-b956-f13011fe3614</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>8e04d032-bad3-4e88-b956-f13011fe3614</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>Path where csv file will be saved</Name>
                  <DefaultValue>%temp%</DefaultValue>
                  <ArgumentNumber>2</ArgumentNumber>
                  <ArgumentName>csvlocation</ArgumentName>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString />
                  <ValidationError />
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
            <item>
              <key>
                <string>dae40a02-e179-4b62-b635-9e19955f27a2</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>dae40a02-e179-4b62-b635-9e19955f27a2</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>Amount of days to audit</Name>
                  <DefaultValue>7</DefaultValue>
                  <ArgumentNumber>1</ArgumentNumber>
                  <ArgumentName>daysback</ArgumentName>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString />
                  <ValidationError />
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
            <item>
              <key>
                <string>b265fba1-43ec-4031-bc9f-28fb37f42f85</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>b265fba1-43ec-4031-bc9f-28fb37f42f85</ArgumentId>
                  <ArgumentType>2</ArgumentType>
                  <Name>HzPrimaryConnectionServer</Name>
                  <ArgumentNumber>0</ArgumentNumber>
                  <ArgumentName>ConnectionServerFQDN</ArgumentName>
                  <EmptyBehavior>0</EmptyBehavior>
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>256</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
            <item>
              <key>
                <string>aa5f89e9-08c3-4dd1-a18d-19d3424e4564</string>
              </key>
              <value>
                <SBAArgumentDescriptor>
                  <ArgumentId>aa5f89e9-08c3-4dd1-a18d-19d3424e4564</ArgumentId>
                  <ArgumentType>1</ArgumentType>
                  <Name>Csv filename</Name>
                  <DefaultValue>CU_Horizon_error_log.csv</DefaultValue>
                  <ArgumentNumber>3</ArgumentNumber>
                  <ArgumentName>csvfilename</ArgumentName>
                  <EmptyBehavior>0</EmptyBehavior>
                  <ValidationString />
                  <ValidationError />
                  <MaskTypedCharacters>false</MaskTypedCharacters>
                  <EntityType>0</EntityType>
                </SBAArgumentDescriptor>
              </value>
            </item>
          </sxSerializedDictionaryOfStringSBAArgumentDescriptor>
        </inner>
      </Arguments>
      <InstructionsExecutionOnComputer />
      <SupressOutputDialog>false</SupressOutputDialog>
      <UseSdk>false</UseSdk>
    </ExecutionDescriptor>
    <MissingCred>false</MissingCred>
    <ImportValidationString>DnG39iIJEaT9iRdc0CRCRvUYs9E=</ImportValidationString>
    <IsVersionAudited>false</IsVersionAudited>
  </SBADescriptor>
</ArrayOfSBADescriptor>